{"version":3,"sources":["webpack:///./web/static/js/app/components/chat/MessageComposer.react.js?efe1"],"names":[],"mappings":"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","file":"0.f62d061289a7c57bca1f.hot-update.js","sourcesContent":["\nimport { connect } from 'react-redux'\nvar React = require('react');\nvar ENTER_KEY_CODE = 13;\nvar debounce = require('lodash.debounce');\n\nimport $ from 'jquery';\nimport AtMentionProvider from './suggestion/at_mention_provider';\nimport CommandProvider from './suggestion/command_provider';\nimport EmoticonProvider from './suggestion/emoticon_provider';\nimport SuggestionList from './suggestion/suggestion_list';\nimport SuggestionBox from './suggestion/suggestion_box';\n\nimport * as TextFormatting from '../../utils/text_formatting';\n\nconst PreReleaseFeatures = Constants.PRE_RELEASE_FEATURES;\n\nimport {intlShape, injectIntl, defineMessages, FormattedHTMLMessage,FormattedMessage} from 'react-intl';\n\nvar attachMediaStream = require('attachmediastream');\n\nconst Preferences = Constants.Preferences;\nconst TutorialSteps = Constants.TutorialSteps;\nconst ActionTypes = Constants.ActionTypes;\n\n\nimport MsgTyping from './msg_typing.jsx';\n\nimport FileUpload from './files/file_upload.jsx';\nimport FilePreview from './files/file_preview.jsx';\n\nimport TutorialTip from '../tutorial/tutorial_tip';\nimport * as ChatActions from '../../actions/chatActions';\nimport * as Utils from '../../utils/general';\nimport Constants from '../../constants/chat_constants';\n\n\nvar ReactDOM = require('react-dom');\n\nvar  KeyCodes = require(\"../../utils/keyCode\");\n\nconst holders = defineMessages({\n    comment: {\n        id: 'create_post.comment',\n        defaultMessage: 'Comment',\n        description: \"comment\"\n    },\n    post: {\n        id: 'create_post.post',\n        defaultMessage: 'Post',\n         description: \"post\"\n    },\n    write: {\n        id: 'create_post.write',\n        defaultMessage: 'Write a message...',\n         description: \"message\"\n    }\n});\n\n\n\n\nvar MessageComposer = React.createClass({\n\n\n  getInitialState: function() {\n      const draft = this.getCurrentDraft();\n    return {messageText: '',\n            channelId: this.props.currentChat.id,\n            messageText: draft.messageText,\n            uploadsInProgress: draft.uploadsInProgress,\n            previews: draft.previews,\n            submitting: false,\n            initialText: draft.messageText,\n            ctrlSend: false,\n            showTutorialTip: true,\n            showPostDeletedModal: false,\n            chatstate: '',\n            editing: false,\n        typing: false,\n        paused: false,\n        active: false,\n        placeholder: false\n\n\n    };\n  },\n\n  handleUserInput(messageText) {\n        this.setState({messageText});\n        if (!this.state.typing) {\n            this.setState({typing:true});\n             store.dispatch(ChatActions.sendPresence('composing'));\n        }\n    },\n\n   getFileCount(channelId) {\n\n   },\n      handleHeightChange(height) {\n        const textbox = $(this.refs.message.getTextbox());\n        const wrapper = $(this.refs.wrapper);\n\n        const maxHeight = parseInt(textbox.css('max-height'), 10);\n\n        // move over attachment icon to compensate for the scrollbar\n        if (height > maxHeight) {\n            wrapper.closest('.post-body__cell').addClass('scroll');\n        } else {\n            wrapper.closest('.post-body__cell').removeClass('scroll');\n        }\n    },\n    handleSubmit(e) {\n        e.preventDefault();\n        var text = this.state.messageText;\n\n        if (text.trim().length === 0 ) {\n            return;\n        }\n\n        this.setState({submitting: true, serverError: null});\n\n        if (text.indexOf('/') === 0) {\n            /*Client.executeCommand(\n                this.state.channelId,\n                post.message,\n                false,\n                (data) => {\n                    PostStore.storeDraft(this.state.channelId, null);\n                    this.setState({messageText: '', submitting: false, postError: null, previews: [], serverError: null});\n\n                    if (data.goto_location && data.goto_location.length > 0) {\n                        browserHistory.push(data.goto_location);\n                    }\n                },\n                (err) => {\n                    if (err.sendMessage) {\n                        this.sendMessage(post);\n                    } else {\n                        const state = {};\n                        state.serverError = err.message;\n                        state.submitting = false;\n                        this.setState(state);\n                    }\n                }\n            );*/\n        } else {\n            this.sendMessage(text);\n        }\n    },\n\n    sendMessage(text) {\n            if (!this.props.currentChat.id){\n                return ;\n            }\n            //ChatActions.emitUserPostedEvent(post);\n            this.setState({editing:false});\n            this.setState({typing:false});\n            this.setState({paused:false});\n            //this.sendChatState('active');\n\n\n            this.setState({messageText: '',\n                           submitting: false,\n                           postError: null,\n                           previews: [],\n                           serverError: null,\n                           editing: false,\n                            typing: false,\n                             paused:false\n                            });\n           var currentChat = this.props.currentChat;\n\n           store.dispatch(ChatActions.sendMessage(text, currentChat.chat,currentChat.id));\n\n\n        },\n\nhandleKeyUp(e){\n    if (this.state.typing && this.state.messageText.length === 0) {\n            this.setState({typing:false});\n            store.dispatch(ChatActions.sendPresence('active'));\n        } else if (this.state.typing) {\n            this.handlePausedTyping();\n        }\n\n},\n handlePausedTyping: debounce(function () {\n        if (this.state.typing && !this.state.paused) {\n            this.setState({paused: true});\n            store.dispatch(ChatActions.sendPresence('paused'));\n        }\n    }, 3000),\n    postMsgKeyPress(e) {\n            if (this.state.ctrlSend && e.ctrlKey || !this.state.ctrlSend) {\n                if (e.which === KeyCodes.ENTER && !e.shiftKey && !e.altKey) {\n                    e.preventDefault();\n                    ReactDOM.findDOMNode(this.refs.message).blur();\n                    this.handleSubmit(e);\n                }\n            }\n\n            //ChatActions.emitLocalUserTypingEvent(this.state.channelId, '');\n        },\n    removePreview(id) {\n            const previews = Object.assign([], this.state.previews);\n            const uploadsInProgress = this.state.uploadsInProgress;\n\n            // id can either be the path of an uploaded file or the client id of an in progress upload\n            let index = previews.indexOf(id);\n            if (index === -1) {\n                index = uploadsInProgress.indexOf(id);\n\n                if (index !== -1) {\n                    uploadsInProgress.splice(index, 1);\n                    this.refs.fileUpload.getWrappedInstance().cancelUpload(id);\n                }\n            } else {\n                previews.splice(index, 1);\n            }\n\n            const draft = {};//PostStore.getCurrentDraft();\n            draft.previews = previews;\n            draft.uploadsInProgress = uploadsInProgress;\n            //PostStore.storeCurrentDraft(draft);\n\n            this.setState({previews, uploadsInProgress});\n        },\n       handleUserInput(messageText) {\n        this.setState({messageText});\n\n    },\n   handleUploadClick() {\n        this.focusTextbox();\n    },\n    handleUploadStart(clientIds, channelId) {\n\n\n        // this is a bit redundant with the code that sets focus when the file input is clicked,\n        // but this also resets the focus after a drag and drop\n        this.focusTextbox();\n    },\n    handleFileUploadComplete(filenames, clientIds, channelId) {\n\n\n\n    },\n     handleUploadClick() {\n        this.focusTextbox();\n    },\n    handleUploadError(err, clientId) {\n        let message = err;\n        if (message && typeof message !== 'string') {\n            // err is an AppError from the server\n            message = err.message;\n        }\n\n        this.setState({serverError: message});\n    },\n\n\n        getCurrentDraft() {\n        const draft = null;\n        const safeDraft = {previews: [], messageText: '', uploadsInProgress: []};\n\n        if (draft) {\n            if (draft.message) {\n                safeDraft.messageText = draft.message;\n            }\n            if (draft.previews) {\n                safeDraft.previews = draft.previews;\n            }\n            if (draft.uploadsInProgress) {\n                safeDraft.uploadsInProgress = draft.uploadsInProgress;\n            }\n        }\n\n        return safeDraft;\n    },\n    handleKeyDown(e) {\n          var arrowKeys = {\n            37: true,\n            38: true,\n            39: true,\n            40: true\n        };\n        if (this.state.ctrlSend && e.keyCode === KeyCodes.ENTER && e.ctrlKey === true) {\n            this.postMsgKeyPress(e);\n            return;\n        }\n\n        if (e.keyCode === KeyCodes.UP && this.state.messageText === '') {\n            e.preventDefault();\n\n            const channelId = this.props.currentChat.id;\n            const lastPost = this.props.message.lastPost;\n            if (!lastPost) {\n                return;\n            }\n            const {formatMessage} = this.props.intl;\n            var type = (lastPost.root_id && lastPost.root_id.length > 0) ? formatMessage(holders.comment) : formatMessage(holders.post);\n\n            if (!arrowKeys[e.which] && !e.ctrlKey && !e.metaKey && (!this.state.typing || this.state.paused)) {\n            this.setState({typing:true})\n            this.setState({paused:false})\n                store.dispatch(ChatActions.sendPresence('composing'));\n        }\n\n\n            store.dispatch({\n                        type: ActionType.MESSAGE_CREATED_EDITED,\n                        refocusId: '#post_textbox',\n                         title: type,\n                         message: lastPost.message,\n                         postId: lastPost.id,\n                         channelId: lastPost.channel_id,\n                        });\n\n        }\n    },\n\n createTutorialTip() {\n        const screens = [];\n\n        screens.push(\n            <div>\n                <FormattedHTMLMessage\n                    id='create_post.tutorialTip'\n                    defaultMessage='<h4>Sending Messages</h4><p>Type here to write a message and press <strong>Enter</strong> to post it.</p><p>Click the <strong>Attachment</strong> button to upload an image or a file.</p>'\n                />\n            </div>\n        );\n\n        return (\n            <TutorialTip\n                placement='top'\n                screens={screens}\n                overlayClass='tip-overlay--chat'\n            />\n        );\n    },\n\n  render: function() {\n      const {actions,dispatch} = this.props;\n        let serverError = null;\n        if (this.state.serverError) {\n            serverError = (\n                <div className='has-error'>\n                    <label className='control-label'>{this.state.serverError}</label>\n                </div>\n            );\n        }\n\n         let postError = null;\n        if (this.state.postError) {\n            postError = <label className='control-label'>{this.state.postError}</label>;\n        }\n\n        let preview = null;\n        if (this.state.previews.length > 0 || this.state.uploadsInProgress.length > 0) {\n            preview = (\n                <FilePreview\n                    files={this.state.previews}\n                    onRemove={this.removePreview}\n                    uploadsInProgress={this.state.uploadsInProgress}\n                />\n            );\n        }\n        let postFooterClassName = 'post-create-footer';\n        if (postError) {\n            postFooterClassName += ' has-error';\n        }\n\n       const hasText = this.state.messageText.length > 0;\n\n        let previewLink = null;\n        if (Utils.isFeatureEnabled(PreReleaseFeatures.MARKDOWN_PREVIEW)) {\n            previewLink = (\n                <a\n                    onClick={this.showPreview}\n                    className='textbox-preview-link'\n                >\n                    {this.state.preview ? (\n                        <FormattedMessage\n                            id='textbox.edit'\n                            defaultMessage='Edit message'\n                        />\n                    ) : (\n                        <FormattedMessage\n                            id='textbox.preview'\n                            defaultMessage='Preview'\n                        />\n                    )}\n                </a>\n            );\n        };\n        const helpText = (\n            <div\n                style={{visibility: hasText ? 'visible' : 'hidden', opacity: hasText ? '0.3' : '0'}}\n                className='help__format-text'\n            >\n                <b>\n                    <FormattedMessage\n                        id='textbox.bold'\n                        defaultMessage='**bold**'\n                    />\n                </b>\n                <i>\n                    <FormattedMessage\n                        id='textbox.italic'\n                        defaultMessage='_italic_'\n                    />\n                </i>\n                <span>\n                    {'~~'}\n                    <strike>\n                        <FormattedMessage\n                            id='textbox.strike'\n                            defaultMessage='strike'\n                        />\n                    </strike>\n                    {'~~ '}\n                </span>\n                <code>\n                    <FormattedMessage\n                        id='textbox.inlinecode'\n                        defaultMessage='`inline code`'\n                    />\n                </code>\n                <code>\n                    <FormattedMessage\n                        id='textbox.preformatted'\n                        defaultMessage='```preformatted```'\n                    />\n                </code>\n                <span>\n                    <FormattedMessage\n                        id='textbox.quote'\n                        defaultMessage='>quote'\n                    />\n                </span>\n            </div>\n        );\n       let tutorialTip = null;\n        if (this.state.showTutorialTip) {\n            tutorialTip = this.createTutorialTip();\n        };\n\n\n      var suggestionProviders = [new AtMentionProvider(), new EmoticonProvider()];\n\n      suggestionProviders.push(new CommandProvider());\n\n\n    return (\n\n            <div>\n\n\n            <div  ref='wrapper'  className='textarea-wrapper' >\n                <SuggestionBox\n                    ref='message'\n                    currentSuggestion={this.props.currentSuggestion}\n                    selectedSuggestion={this.props.selectedSuggestion}\n                    className={`form-control custom-textarea ${this.state.connection}`}\n                    type='textarea'\n                    spellCheck='true'\n                    autoComplete='off'\n                    autoCorrect='off'\n                    maxLength={Constants.MAX_POST_LEN}\n                    placeholder={\"compose\"}\n                    value={this.state.messageText}\n                    onKeyDown={this.handleKeyDown}\n                    onKeyUp ={this.handleKeyUp}\n                    onHeightChange={this.handleHeightChange}\n                    style={{visibility: this.state.preview ? 'hidden' : 'visible'}}\n                    listComponent={SuggestionList}\n                    providers={suggestionProviders}\n                    channelId={this.props.currentChat.id}\n                    onUserInput={this.handleUserInput}\n                    onKeyPress={this.postMsgKeyPress}\n                    actions={actions}\n                    dispatch={dispatch}\n                                id='message_textbox'\n\n                />\n\n                                    <FileUpload\n                                    ref='fileUpload'\n                                    getFileCount={this.getFileCount}\n                                    onClick={this.handleUploadClick}\n                                    onUploadStart={this.handleUploadStart}\n                                    onFileUpload={this.handleFileUploadComplete}\n                                    onUploadError={this.handleUploadError}\n                                    postType='post'\n                                    channelId=''\n                                    actions={actions}\n                            />\n\n\n            </div>\n\n\n\n\n\n                <div className='help__text'>\n                    {helpText}\n                    {previewLink}\n                    <a\n                        target='_blank'\n                        href='/help/getting-started/messaging-basics.html'\n                        className='textbox-help-link'\n                    >\n                        <FormattedMessage\n                            id='textbox.help'\n                            defaultMessage='Help'\n                        />\n                    </a>\n                </div>\n\n\n\n                        {tutorialTip}\n\n\n                    <div className={postFooterClassName}>\n                        <MsgTyping\n                            channelId={this.state.channelId}\n                            parentId={''}\n                        />\n                        {preview}\n                        {postError}\n                        {serverError}\n                    </div>\n    </div>\n\n\n    );\n  },\n\nfocus() {\n        this.refs.message.getTextbox().focus();\n    },\nfocusTextbox() {\n        if (!Utils.isMobile()) {\n            this.refs.message.focus();\n        }\n    },\n\n\nshowPreview(e) {\n        e.preventDefault();\n        e.target.blur();\n        this.setState({preview: !this.state.preview});\n    }\n\n\n\n});\n\nexport default injectIntl(MessageComposer);\n\n\n\n/** WEBPACK FOOTER **\n ** ./web/static/js/app/components/chat/MessageComposer.react.js\n **/"],"sourceRoot":""}