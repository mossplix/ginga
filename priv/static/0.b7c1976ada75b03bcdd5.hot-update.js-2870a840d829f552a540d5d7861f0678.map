{"version":3,"sources":["webpack:///./web/static/js/app/components/chat/suggestion/suggestion_box.jsx?169e"],"names":[],"mappings":"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","file":"0.b7c1976ada75b03bcdd5.hot-update.js","sourcesContent":["// Copyright (c) 2016 Sparkplug, Inc. All Rights Reserved.\n\nimport $ from 'jquery';\nimport ReactDOM from 'react-dom';\n\nimport ActionTypes from '../../../constants';\nimport ChatConstants from '../../../constants'\n\nimport * as Utils from '../../../utils/general';\n\nimport TextareaAutosize from 'react-textarea-autosize';\nimport * as ChatActions from '../../../actions/chatActions';\n\nconst KeyCodes = ChatConstants.KeyCodes;\n\nimport React from 'react';\n\nexport default class SuggestionBox extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.handleDocumentClick = this.handleDocumentClick.bind(this);\n\n        this.handleChange = this.handleChange.bind(this);\n        //this.handleCompleteWord = this.handleCompleteWord.bind(this);\n        this.handleKeyDown = this.handleKeyDown.bind(this);\n       // this.handlePretextChanged = this.handlePretextChanged.bind(this);\n\n        this.suggestionId = Utils.generateId();\n        this.state={term:'',pretext:''};\n    }\n\n    componentDidMount() {\n\n        const {actions,dispatch} = this.props;\n\n        dispatch(actions.registerSuggestions(this.suggestionId));\n\n\n        $(document).on('click', this.handleDocumentClick);\n\n\n       // this.handleCompleteWord(this.props);\n\n\n\n       // SuggestionStore.addCompleteWordListener(this.suggestionId, this.handleCompleteWord);\n        //SuggestionStore.addPretextChangedListener(this.suggestionId, this.handlePretextChanged);\n    }\n\n    componentWillUnmount() {\n        //SuggestionStore.removeCompleteWordListener(this.suggestionId, this.handleCompleteWord);\n        //SuggestionStore.removePretextChangedListener(this.suggestionId, this.handlePretextChanged);\n\n         const {actions,dispatch} = this.props;\n\n        dispatch(actions.unregisterSuggestions(this.suggestionId));\n\n\n        $(document).off('click', this.handleDocumentClick);\n    }\n\n    getTextbox() {\n        // this is to support old code that looks at the input/textarea DOM nodes\n        let textbox = this.refs.textbox;\n\n        if (!(textbox instanceof HTMLElement)) {\n            textbox = ReactDOM.findDOMNode(textbox);\n        }\n\n        return textbox;\n    }\n\n    handleDocumentClick(e) {\n        const container = $(ReactDOM.findDOMNode(this));\n        if (!(container.is(e.target) || container.has(e.target).length > 0)) {\n            // we can't just use blur for this because it fires and hides the children before\n            // their click handlers can be called\n\n\n            const {actions,dispatch} = this.props;\n\n        dispatch(actions.clearSuggestions(this.suggestionId));\n        }\n    }\n\n    handleChange(e) {\n        const textbox = ReactDOM.findDOMNode(this.refs.textbox);\n        const caret = Utils.getCaretPosition(textbox);\n        const pretext = textbox.value.substring(0, caret);\n\n\n         const {actions,dispatch} = this.props;\n\n        dispatch(actions.suggestionPretextChanged(this.suggestionId,pretext));\n\n\n\n        if (this.props.onUserInput) {\n            this.props.onUserInput(textbox.value);\n        }\n\n        if (this.props.onChange) {\n            this.props.onChange(e);\n        }\n    }\n\n    componentWillReceiveProps(nextProps) {\n\n        if (this.state.term !==  nextProps.selectedSuggestion.matched_term){\n             this.handleCompleteWord(nextProps);\n            this.setState({\n                term:nextProps.selectedSuggestion.matched_term\n            });\n\n        }\n\n         if (this.state.pretext !==  nextProps.selectedSuggestion.pretext){\n             this.handlePretextChanged(nextProps.selectedSuggestion.pretext);\n            this.setState({\n                pretext:nextProps.selectedSuggestion.pretext\n            });\n\n        }\n\n\n\n\n\n }\n\n    handleCompleteWord(props) {\n\n        const term = props.selectedSuggestion.matched_term||\"\";\n        const textbox = ReactDOM.findDOMNode(this.refs.textbox);\n        const caret = Utils.getCaretPosition(textbox);\n        const pretext = props.selectedSuggestion.matchedPretext||[];\n\n        const text = this.props.value;\n        const prefix = text.substring(0, caret - pretext.length);\n        const suffix = text.substring(caret);\n\n        if (this.props.onUserInput) {\n            this.props.onUserInput(prefix + term + ' ' + suffix);\n        }\n\n        // set the caret position after the next rendering\n        window.requestAnimationFrame(() => {\n            Utils.setCaretPosition(textbox, prefix.length + term.length + 1);\n        });\n\n     store.dispatch(ChatActions.clearSelection(this.suggestionId));\n       store.dispatch(ChatActions.clearSuggestions(this.suggestionId));\n    }\n\n    handleKeyDown(e) {\n         const {actions,dispatch} = this.props;\n        if (this.props.selectedSuggestion.hasSuggestions) {\n            if (e.which === KeyCodes.UP) {\n\n                dispatch(actions.selectPreviousSuggestion(this.suggestionId));\n                e.preventDefault();\n            } else if (e.which === KeyCodes.DOWN) {\n                dispatch(actions.selectNextSuggestion(this.suggestionId));\n                e.preventDefault();\n            } else if (e.which === KeyCodes.ENTER || e.which === KeyCodes.TAB) {\n\n\n                dispatch(actions.completeWordSuggestion(this.suggestionId));\n\n                e.preventDefault();\n            } else if (this.props.onKeyDown) {\n                this.props.onKeyDown(e);\n            }\n        } else if (this.props.onKeyDown) {\n            this.props.onKeyDown(e);\n        }\n    }\n\n    handlePretextChanged(pretext) {\n        for (const provider of this.props.providers) {\n            provider.handlePretextChanged(this.suggestionId, pretext);\n        }\n    }\n\n\n\n    render() {\n        const newProps = Object.assign({}, this.props, {\n            onChange: this.handleChange,\n            onKeyDown: this.handleKeyDown\n        });\n\n        let textbox = null;\n        if (this.props.type === 'input') {\n            textbox = (\n                <input\n                    ref='textbox'\n                    type='text'\n                    {...newProps}\n                />\n            );\n        } else if (this.props.type === 'search') {\n            textbox = (\n                <input\n                    ref='textbox'\n                    type='search'\n                    {...newProps}\n                />\n            );\n        } else if (this.props.type === 'textarea') {\n            textbox = (\n                <TextareaAutosize\n                    id={this.suggestionId}\n                    ref='textbox'\n                    {...newProps}\n                />\n            );\n        }\n\n        const SuggestionListComponent = this.props.listComponent;\n\n        return (\n            <div>\n                {textbox}\n                <SuggestionListComponent suggestionId={this.suggestionId} actions={this.props.actions} selectedSuggestion={this.props.selectedSuggestion} dispatch={this.props.dispatch} currentSuggestion={this.props.currentSuggestion}/>\n            </div>\n        );\n    }\n}\n\nSuggestionBox.defaultProps = {\n    type: 'input'\n};\n\nSuggestionBox.propTypes = {\n    listComponent: React.PropTypes.func.isRequired,\n    type: React.PropTypes.oneOf(['input', 'textarea', 'search']).isRequired,\n    value: React.PropTypes.string.isRequired,\n    onUserInput: React.PropTypes.func,\n    providers: React.PropTypes.arrayOf(React.PropTypes.object),\n\n    // explicitly name any input event handlers we override and need to manually call\n    onChange: React.PropTypes.func,\n    onKeyDown: React.PropTypes.func,\n    onHeightChange: React.PropTypes.func\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./web/static/js/app/components/chat/suggestion/suggestion_box.jsx\n **/"],"sourceRoot":""}